# 图片处理工具套件 - UI设计文档

## 1. 概述

本文档描述了图片处理工具套件的现代化UI/UX设计方案，采用插件化3栏式布局，使用ttkbootstrap库实现深色主题的现代界面，支持多种图片处理功能的动态切换。

## 2. 整体布局设计

### 2.1 布局比例
- **左栏（功能选择）**：20% 宽度
- **中栏（设置与进度）**：25% 宽度
- **右栏（功能工作区）**：55% 宽度

### 2.2 布局特点
- 使用ttkbootstrap的深色主题（"superhero"或"darkly"）作为基础
- 所有面板和控件采用圆角设计
- 响应式布局，可调整栏宽比例
- 支持最小窗口尺寸（1200x700）
- 栏与栏之间有细微分隔线，可拖动调整宽度

### 2.3 整体结构
```
┌─────────────────────────────────────────────────────────────────┐
│  标题栏 - 图片处理工具套件                                        │
├──────────┬──────────────────┬─────────────────────────────────────┤
│          │                  │                                     │
│  左栏    │     中栏         │             右栏                    │
│ (20%)    │    (25%)         │           (55%)                    │
│          │                  │                                     │
│ 功能选择 │   设置与进度     │       动态功能工作区                 │
│          │                  │                                     │
│ • 图片去重│ • 参数设置       │  • 功能相关的                      │
│ • AVIF转换│ • 进度显示       │    动态界面                        │
│ • 批量重命名│ • 状态日志     │                                     │
│ • 图片优化 │ • 操作按钮       │                                     │
│          │                  │                                     │
└──────────┴──────────────────┴─────────────────────────────────────┘
│  状态栏 - 状态信息、提示                                         │
└─────────────────────────────────────────────────────────────────┘
```
### 2.5视觉层次优化
背景层: #1E1E1E (96%不透明度)
│   ├─ 内容层: #2D2D2D (100%不透明度)
│   ├─ 卡片层: #3A3A3A (轻微阴影)
│   └─ 悬浮层: #454545 (悬停效果)
│
└─ 焦点层: #505050 (选中状态)

## 3. 左栏 - 功能选择

### 3.1 主要功能
- 功能模块列表：显示所有可用的图片处理功能模块
- 动态按钮：根据功能模块动态生成功能选择按钮
- 功能描述：每个功能显示图标、名称和描述信息
- 激活状态：当前激活的功能模块高亮显示

### 3.2 UI设计详情
```
┌─────────────────────────┐
│  🔧 功能选择             │
├─────────────────────────┤
│  ┌───────────────────┐  │
│  │ 🔍 图片去重       │  │
│  │ 查找并处理重复    │  │
│  │ 或相似的图片       │  │
│  └───────────────────┘  │
│                          │
│  ┌───────────────────┐  │
│  │ 🗜️ AVIF转换      │  │
│  │ 将图片转换为AVIF  │  │
│  │ 格式以节省空间     │  │
│  └───────────────────┘  │
│                          │
│  ┌───────────────────┐  │
│  │ 📝 批量重命名     │  │
│  │ 批量重命名图片    │  │
│  │ 文件             │  │
│  └───────────────────┘  │
│                          │
│  ┌───────────────────┐  │
│  │ ⚡ 图片优化       │  │
│  │ 优化图片质量和    │  │
│  │ 大小             │  │
│  └───────────────────┘  │
└─────────────────────────┘
```

### 3.4 样式规范（更新）
- **未选中卡片**：灰色背景（#353535），无边框，白色文字
- **选中卡片**：浅灰色背景（#404040），橙色边框（#FF8C00），文字颜色不变
- **悬停效果**：背景色略微变亮（#3A3A3A）
- **卡片间距**：5px，紧凑布局

### 3.3 交互特性
- 功能按钮有视觉反馈（悬停时高亮，激活时变色）
- 功能描述文本自动换行，保持界面整洁
- 支持点击切换功能，无需重启应用
- 当前激活功能有明显的高亮显示
- 功能图标使用统一的视觉风格

## 4. 中栏 - 设置与进度显示

### 4.1 主要功能
- 动态设置区域：根据当前激活的功能模块显示相应的参数设置
- 实时进度条：显示当前功能的执行进度和状态
- 统计信息：显示当前功能的相关统计和数据
- 日志区域：实时显示处理日志，支持不同级别的日志
- 操作按钮：执行、停止、配置等操作控制

### 4.2 UI设计详情（图片去重功能示例）
```
┌─────────────────────────────┐
│  🔍 图片去重设置             │
├─────────────────────────────┤
│  📁 扫描路径:               │
│  [E:\图片] [...📁]          │
│                             │
│  ⚙️ 检测设置:               │
│  敏感度: [■■■■■■■□□□] 70%   │
│  包含子目录: [✓]            │
│  文件类型: [jpg,png,gif]    │
│                             │
│  🚀 操作控制:               │
│  [▶️ 开始扫描] [⏹️ 停止]    │
│                             │
│  📊 执行进度:               │
│  [■■■■■■■■■■□□□□□□] 65%    │
│  当前任务: 计算相似度       │
│                             │
│  📋 处理日志:               │
│  ┌─────────────────────┐   │
│  │ [12:34:56] 开始扫描  │   │
│  │ [12:35:01] 发现文件   │   │
│  │ [12:35:10] 计算哈希   │   │
│  │ [12:35:15] 发现重复   │   │
│  │ [12:35:20] 处理完成   │   │
│  │                     │   │
│  └─────────────────────┘   │
└─────────────────────────────┘
```

### 4.3 交互特性
- 设置区域根据功能模块动态变化，提供相应的参数配置
- 进度条显示百分比和状态文本，实时反馈执行进度
- 统计信息根据当前功能显示相关数据和信息
- 日志支持自动滚动，可锁定滚动位置，不同级别日志使用不同颜色
- 操作按钮根据功能状态动态启用/禁用
- 支持多种功能的设置界面切换（路径选择、质量调节、格式选择等）

## 5. 右栏 - 动态功能工作区

### 5.1 主要功能
- 动态内容区域：根据当前激活的功能模块显示相应的界面
- 图片去重模式：显示重复图片网格、缩略图预览、置信度指示
- AVIF转换模式：显示转换进度、结果统计、前后对比
- 批量重命名模式：显示文件列表、预览、重命名规则设置
- 图片优化模式：显示优化设置、效果预览、质量对比
- 通用功能：结果展示、操作控制、详细信息显示

### 5.2 UI设计详情（图片去重模式示例 - 更新）
```
┌─────────────────────────────────────────────────────────────┐
│  🔍 重复图片结果  [全选] [删除选中] [移动到...] [日志]       │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  [选中] 重复组 1 (4张) [高置信度 98%]                   │ │
│  │  ┌───────┐ ┌───────┐                                   │ │
│  │  │ 🖼️    │ │ 🖼️+2  │  (水平排列，最多2张，多于2张堆叠显示)│ │
│  │  └───────┘ └───────┘                                   │ │
│  │                                                         │ │
│  │  [未选] 重复组 2 (3张) [中置信度 75%]                   │ │
│  │  ┌───────┐ ┌───────┐                                   │ │
│  │  │ 🖼️    │ │ 🖼️+1  │                                   │ │
│  │  └───────┘ └───────┘                                   │ │
│  │                                                         │ │
│  │  [选中] 重复组 3 (2张) [低置信度 45%]                   │ │
│  │  ┌───────┐ ┌───────┐                                   │ │
│  │  │ 🖼️    │ │ 🖼️    │                                   │ │
│  │  └───────┘ └───────┘                                   │ │
│  └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│  📋 日志区域 (可折叠)                                       │
│  [12:34:56] 扫描完成，找到3组重复图片                       │
│  [12:35:01] 选中2组重复图片进行后续操作                     │
└─────────────────────────────────────────────────────────────┘
```

### 5.5 去重功能工作区优化（新增）

**布局优化：**
- **主要区域**：75%用于显示重复项卡片，自适应分栏显示
- **日志区域**：25%可折叠区域，默认折叠，需要时展开
- **紧凑显示**：缩略图尺寸减小，卡片间距优化

**重复项卡片设计：**
- **水平排列**：每张卡片水平显示2张图片
- **堆叠显示**：多于2张图片时，第二张图显示为"+N"堆叠图标
- **紧凑缩略图**：图片尺寸缩小，增加信息密度
- **选中状态**：选中卡片显示橙色边框和浅色背景

**交互功能：**
- **鼠标点选**：点击单个卡片进行选择/取消选择
- **框选功能**：按住鼠标拖动框选多个卡片
- **多选操作**：Ctrl+点击多选，Shift+点击范围选择
- **操作按钮**：选中后显示"删除重复图片（保留一张）"和"移动到..."按钮

**视觉层次：**
- **卡片堆叠**：清晰的堆叠指示，显示隐藏图片数量
- **选中状态**：明显的视觉反馈（橙色边框+浅色背景）
- **置信度标签**：颜色编码（红/黄/绿）对应置信度级别
- **文件信息**：显示文件大小、名称、路径等基本信息

### 5.3 其他功能模式UI设计

**AVIF转换模式：**
```
┌─────────────────────────────────────────────────────────────┐
│  🗜️ AVIF转换结果                                           │
├─────────────────────────────────────────────────────────────┤
│  📊 转换统计:                                              │
│  总文件: 1,250  |  已转换: 800  |  剩余: 450              │
│  原大小: 2.5GB  |  新大小: 1.8GB  |  节省: 28%            │
│                                                          │
│  📋 转换结果:                                              │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 文件名           原大小    新大小    节省率    状态   │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ IMG_001.jpg      2.5MB    1.8MB     28%     ✅      │   │
│  │ IMG_002.jpg      3.2MB    2.1MB     34%     ✅      │   │
│  │ IMG_003.jpg      1.8MB    1.4MB     22%     ⏳      │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

**批量重命名模式：**
```
┌─────────────────────────────────────────────────────────────┐
│  📝 批量重命名                                             │
├─────────────────────────────────────────────────────────────┤
│  ⚙️ 重命名规则:                                          │
│  规则模板: [IMG_{001}.jpg]                               │
│  起始编号: [1]   增量: [1]                               │
│                                                          │
│  📋 文件预览:                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 原文件名          新文件名              状态         │   │
│  ├─────────────────────────────────────────────────────┤   │
│  │ DSC_0001.jpg     IMG_001.jpg           ✅          │   │
│  │ DSC_0002.jpg     IMG_002.jpg           ✅          │   │
│  │ DSC_0003.jpg     IMG_003.jpg           ⏳          │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

### 5.4 交互特性
- **动态界面切换**：右栏内容根据左栏选择的功能自动切换
- **统一操作模式**：所有功能都支持选择、操作、查看详情等基本交互
- **实时预览**：参数调整时实时显示预览效果
- **进度反馈**：长时间操作显示进度条和状态信息
- **结果展示**：使用表格、网格、列表等形式展示处理结果
- **操作控制**：提供执行、暂停、停止、配置等操作按钮
- **详细信息**：支持查看文件详情、处理历史、统计信息等

## 6. 交互功能和用户体验

### 6.1 核心交互流程
1. **功能选择**：在左栏点击选择要使用的功能模块
2. **参数配置**：在中栏配置当前功能的相关参数
3. **执行操作**：点击执行按钮开始处理，实时查看进度
4. **查看结果**：在右栏查看处理结果和详细信息
5. **后续操作**：根据结果进行保存、导出、调整等操作

### 6.2 交互特性
- **功能热切换**：点击左栏功能按钮即可切换，无需重启应用
- **动态界面**：中栏和右栏根据选择的功能自动更新界面
- **统一操作模式**：所有功能都提供相似的交互模式和操作流程
- **去重功能特殊交互**：
  - 鼠标点选：点击单个重复项卡片进行选择
  - 框选功能：按住鼠标拖动框选多个重复项卡片
  - 多选操作：Ctrl+点击多选，Shift+点击范围选择
  - 堆叠预览：鼠标悬停在堆叠图标上显示缩略图预览
- **快捷键支持**：
  - F1：帮助信息
  - Ctrl+E：执行当前功能
  - Ctrl+S：保存结果
  - Delete：删除选中项目
  - Esc：停止当前操作
  - Ctrl+A：全选重复项卡片
  - Ctrl+D：取消选择所有重复项
- **右键菜单**：根据上下文提供相应的操作选项
- **键盘导航**：Tab键在界面元素间切换，方向键选择项目
- **视觉反馈**：
  - 功能切换时界面平滑过渡
  - 操作进度实时显示
  - 错误和成功状态明确提示
  - 加载状态和进度指示
  - 选中卡片橙色边框和浅色背景反馈

### 6.3 用户体验优化
- **一致性体验**：所有功能模块使用统一的UI风格和交互模式
- **响应式设计**：窗口大小调整时自动重新布局
- **实时反馈**：所有操作都有即时的视觉和状态反馈
- **批量操作**：支持多选和批量处理，提高效率
- **预览功能**：参数调整时提供实时预览效果
- **操作历史**：支持撤销和重做操作
- **导出功能**：支持结果导出和报告生成

## 7. 颜色方案和视觉风格

### 7.1 主题选择
- 基础主题：ttkbootstrap的"superhero"（深色主题）
- 主色调：深灰色背景 + 艳色强调色

### 7.2 颜色方案
```
背景色：
- 主背景：#2B2B2B (深灰)
- 面板背景：#343A40 (稍浅的深灰)
- 分隔线：#495057 (中灰)
- 未选中卡片：#353535 (中灰)
- 选中卡片：#404040 (浅灰)

文本色：
- 主文本：#FFFFFF (白色)
- 次要文本：#ADB5BD (浅灰)
- 禁用文本：#6C757D (中灰)

强调色（选择一种艳色）：
- 方案B（活力橙）：#FF8C00 (橙色) - 选中卡片边框和操作按钮

功能色：
- 成功/高置信度：#198754 (绿色)
- 警告/中置信度：#FFC107 (黄色)
- 错误/低置信度：#DC3545 (红色)
- 信息：#0DCAF0 (蓝色)
- 选中状态：#FF8C00 (橙色边框) + #404040 (浅色背景)
```

### 7.3 视觉风格
- **圆角设计**：所有面板和控件使用8px圆角
- **阴影效果**：面板使用轻微内阴影，增强层次感
- **渐变按钮**：主要按钮使用渐变色，增强视觉吸引力
- **图标使用**：使用一致的图标风格，增强可识别性
- **间距统一**：使用8px网格系统，保持界面整洁

### 7.4 按钮样式
```
主要按钮：渐变背景 + 白色文字 + 圆角
- 默认：渐变从左到右
- 悬停：渐变从上到下 + 轻微放大
- 点击：内阴影效果

次要按钮：单色背景 + 白色文字 + 圆角
- 默认：纯色背景
- 悬停：亮度提高
- 点击：内阴影效果
```

## 8. 技术实现要点

### 8.1 核心技术栈
- **UI框架**：ttkbootstrap (基于tkinter)
- **插件架构**：BaseFunctionModule抽象基类和FunctionManager
- **图片处理**：PIL/Pillow, pillow-avif-plugin
- **数值计算**：numpy
- **文件操作**：os, shutil, pathlib
- **多线程**：threading

### 8.2 关键实现点
- **插件化架构**：使用BaseFunctionModule实现功能模块的标准化
- **动态UI生成**：功能模块自动生成对应的UI界面
- **状态管理**：FunctionManager统一管理功能模块的状态和生命周期
- **回调机制**：UI状态实时同步，进度和消息统一管理
- **热切换支持**：运行时动态切换功能，无需重启应用
- **ttkbootstrap集成**：自动检测和适配ttkbootstrap或传统tkinter

### 8.3 功能模块接口
```python
class BaseFunctionModule(ABC):
    @abstractmethod
    def get_ui_panel(self, parent: Frame) -> Frame:
        """返回功能对应的UI面板"""
        pass

    @abstractmethod
    def execute(self, params: Dict[str, Any]) -> bool:
        """执行功能"""
        pass

    @abstractmethod
    def validate_params(self, params: Dict[str, Any]) -> tuple[bool, str]:
        """验证参数"""
        pass
```

### 8.4 性能优化
- **按需加载**：功能模块的UI只在需要时加载
- **资源复用**：UI组件和资源在功能切换时智能复用
- **异步处理**：长时间操作不阻塞UI线程
- **内存管理**：及时释放不用的UI资源和图片数据
- **缓存机制**：缩略图和处理结果缓存，提高响应速度

## 9. 设计原则

### 9.1 用户体验原则
- **简洁直观**：界面布局清晰，操作流程简单
- **反馈及时**：所有操作都有明确的视觉反馈
- **容错性强**：支持撤销操作，防止误操作
- **一致性**：整个应用的交互和视觉风格保持一致

### 9.2 界面设计原则
- **层次分明**：通过颜色、大小、间距建立视觉层次
- **重点突出**：重要功能和信息更加醒目
- **留白适当**：避免界面过于拥挤
- **对齐统一**：保持元素的对齐和间距一致

### 9.3 功能设计原则
- **模块化设计**：每个功能都是独立的模块，便于开发和维护
- **灵活配置**：提供多种配置选项满足不同需求
- **高效操作**：支持批量操作和快捷键
- **可扩展性**：插件化架构支持轻松添加新功能

### 9.4 架构设计原则
- **标准化接口**：所有功能模块实现相同的接口
- **松耦合设计**：功能模块之间相互独立
- **统一管理**：FunctionManager统一管理所有功能模块
- **动态加载**：功能模块按需加载，提高性能

## 10. 总结

本UI设计方案充分考虑了用户体验和技术架构的需求，提供了一个既美观又实用的图片处理工具套件界面。主要特点包括：

1. **插件化3栏布局**：支持多种功能的动态切换和扩展
2. **现代化视觉**：深色主题、圆角设计、渐变按钮
3. **统一交互**：所有功能都有一致的操作模式和交互体验
4. **实时反馈**：进度条、统计信息、操作提示
5. **可扩展架构**：为未来功能扩展提供了标准化的接口

这个设计方案支持图片去重、AVIF转换、批量重命名、图片优化等多种功能，为开发团队提供了明确的UI实现指导，有助于打造一个专业、现代、易用的图片处理工具套件。